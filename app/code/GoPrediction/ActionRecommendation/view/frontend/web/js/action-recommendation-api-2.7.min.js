!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.ActionRecommendationApi=e()}(void 0===this?window:this,function(){var t="http://cloud.goprediction.local/api";return{publicAccessKey:null,action:function(e,o){var n=!0;"function"!=typeof o&&(n=!1,o=function(){});var i=new XMLHttpRequest;if(i.onreadystatechange=function(t){4===i.readyState&&o(i.responseText,i.status)},i.open("POST",t+"/action-recommendation/action",n),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify({customer:e.customer,product_id:e.product_id,public_access_key:this.publicAccessKey})),200===i.status)return i.responseText},query:function(e,o){var n=!0;"function"!=typeof o&&(n=!1,o=function(){});var i="&product_ids="+JSON.stringify(e.product_ids),r="?public_access_key="+this.publicAccessKey+"&count="+e.count+i,c=new XMLHttpRequest;if(c.onreadystatechange=function(t){4===c.readyState&&o(c.responseText,c.status)},c.open("GET",t+"/action-recommendation/query"+r,n),c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Accept","application/json"),c.send(),200===c.status)return c.responseText},_getHistory:function(t){"string"!=typeof t.action&&(t.action=""),t.action=t.action.charAt(0).toUpperCase()+t.action.slice(1);let e=JSON.parse(localStorage.getItem("_gpcCustomer"+t.action+"ActionHistory"));return Array.isArray(e)||(e=[]),e},_setHistory:function(t){"string"!=typeof t.action&&(t.action=""),t.action=t.action.charAt(0).toUpperCase()+t.action.slice(1);let e=JSON.parse(localStorage.getItem("_gpcCustomer"+t.action+"ActionHistory"));Array.isArray(e)||(e=[]),e.includes(t.produc_id)||e.push(t.product_id),e=e.slice(-5),localStorage.setItem("_gpcCustomer"+t.action+"ActionHistory",JSON.stringify(e))},_generateCustomerIdentifier:function(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<32;o++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},_getCustomerIdentifier:function(){var t=localStorage.getItem("_gpcCustomerIdentifier");return t||(t=this._generateCustomerIdentifier(),localStorage.setItem("_gpcCustomerIdentifier",t)),t}}});
